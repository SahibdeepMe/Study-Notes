<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Cell Biology Live Lesson</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- Premium Educational Dark Theme --- */
        :root {
            --bg-color: #0d1321; /* Deep Navy/Indigo */
            --card-bg: #1e293b; /* Slate */
            --text-color: #e2e8f0; /* Off-White */
            --primary-accent: #38bdf8; /* Sky Blue */
            --secondary-accent: #a78bfa; /* Violet */
            --gradient-start: #1e293b;
            --gradient-end: #0d1321;
            --border-color: #334155;
            --shadow-color: rgba(0, 0, 0, 0.7);
        }

        body {
            background: linear-gradient(180deg, var(--gradient-start) 0%, var(--bg-color) 100%);
            color: var(--text-color);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; 
            scroll-behavior: smooth;
        }
        
        /* --- Scroll Reveal Animation --- */
        .section-container {
            min-height: 100vh; /* Ensures full-page feel */
            padding-top: 5rem;
            padding-bottom: 5rem;
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .section-container.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 15px 30px var(--shadow-color);
            transition: all 0.3s;
            border-radius: 1.5rem; /* Large rounded corners */
        }

        /* --- Interactivity Styles --- */
        .interactive-element {
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s, transform 0.1s;
        }
        .interactive-element:hover {
            box-shadow: 0 0 10px var(--primary-accent);
        }
        .interactive-element:active {
            transform: scale(0.99);
        }

        /* --- Organelle Animation (Endomembrane System - S5) --- */
        /* Updated keyframes to use absolute 'left' percentages for smooth, precise movement between RER, Golgi, and Export */
        @keyframes vesicle-move {
            0% { 
                left: 10%; /* Start position (near RER) */
                opacity: 1; 
                transform: translateY(-50%) scale(1);
                background-color: #fcd34d; /* Yellow (Start) */
            }
            33% { 
                left: 40%; /* Approaching Golgi */
                transform: translateY(-50%) scale(1.1); 
                background-color: #fca5a5; /* Pink (Middle) */
            }
            66% { 
                left: 70%; /* Approaching Export */
                opacity: 0.8; 
                transform: translateY(-50%) scale(0.9); 
                background-color: #a78bfa; /* Violet (End) */
            }
            100% { 
                left: 90%; /* Exits right */
                opacity: 0; 
                transform: translateY(-50%) scale(1);
            }
        }

        .vesicle-animation {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            /* Initial starting position (must match 0% keyframe start) */
            left: 10%; 
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            box-shadow: 0 0 10px currentColor;
        }
        .vesicle-animation.active {
            animation: vesicle-move 3s ease-in-out forwards;
        }
    </style>
</head>
<body>

    <div id="app" class="max-w-4xl mx-auto px-4 sm:px-8">
        
        <!-- Header - Fixed/Sticky -->
        <header class="sticky top-0 z-20 w-full pt-8 pb-4 mb-10 bg-[var(--bg-color)]/95 backdrop-blur-sm border-b border-[var(--border-color)] shadow-xl">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-[var(--primary-accent)] text-center tracking-tight">
                ðŸ§¬ Cell Biology: The Interactive Lesson
            </h1>
            <p class="text-center text-sm text-gray-400 mt-2">Scroll Down to Begin Your Live Class</p>
        </header>

        <!-- 1. Overview: Cell Theory -->
        <section id="sec-1" class="section-container">
            <div class="card p-10 space-y-6">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)]">1. Overview: The Cell Theory</h2>
                <p class="text-xl opacity-80 border-l-4 border-yellow-400 pl-4 py-2 bg-[var(--gradient-start)]/50 rounded-md">
                    The cell is the **fundamental, functional, and structural unit** of all known living organisms.
                </p>
                <ul class="space-y-3 text-lg list-none pl-0">
                    <li class="p-3 bg-gray-700/30 rounded-lg shadow-inner">1. All living things are composed of one or more cells.</li>
                    <li class="p-3 bg-gray-700/30 rounded-lg shadow-inner">2. The cell is the basic structural and functional unit of life.</li>
                    <li class="p-3 bg-gray-700/30 rounded-lg shadow-inner">3. All cells arise from pre-existing cells.</li>
                </ul>
            </div>
        </section>

        <!-- 2. Key Concepts: Prokaryotic vs. Eukaryotic (Interactive Comparison) -->
        <section id="sec-2" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--primary-accent)]">2. Key Concepts: Pro vs. Eu (Toggle View)</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    Life is categorized into two fundamental cell types. Click the tabs below to compare their structure and complexity.
                </p>

                <div class="flex justify-center space-x-4 mb-6">
                    <button id="btn-pro" class="tab-button p-3 w-40 rounded-full font-bold text-lg bg-red-600 hover:bg-red-700 interactive-element transition-colors">Prokaryote</button>
                    <button id="btn-eu" class="tab-button p-3 w-40 rounded-full font-bold text-lg bg-blue-600 hover:bg-blue-700 interactive-element transition-colors">Eukaryote</button>
                </div>

                <div id="pro-content" class="tab-content space-y-4 text-left p-6 bg-red-900/40 border border-red-500 rounded-xl">
                    <h3 class="text-2xl font-semibold text-red-300">Prokaryotic Cells (Simple)</h3>
                    <p>Bacteria and Archaea. They are generally smaller (0.1 - 5 micrometers).</p>
                    <p class="text-lg font-mono text-yellow-300">KEY: NO MEMBRANE-BOUND NUCLEUS OR ORGANELLES.</p>
                    <p>DNA is in a region called the **Nucleoid**.</p>
                </div>

                <div id="eu-content" class="tab-content space-y-4 text-left p-6 bg-blue-900/40 border border-blue-500 rounded-xl hidden">
                    <h3 class="text-2xl font-semibold text-blue-300">Eukaryotic Cells (Complex)</h3>
                    <p>Plants, Animals, Fungi, Protists. They are larger (10 - 100 micrometers).</p>
                    <p class="text-lg font-mono text-yellow-300">KEY: TRUE NUCLEUS AND MANY MEMBRANE-BOUND ORGANELLES.</p>
                    <p>They are highly compartmentalized for advanced functions.</p>
                </div>
            </div>
        </section>

        <!-- 3. Visual Diagrams: The Eukaryotic Cell (Diagram + Components) -->
        <section id="sec-3" class="section-container">
            <div class="card p-10 space-y-6">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)] text-center">3. The Eukaryotic Cell: The Factory Floor</h2>
                <p class="text-lg opacity-80 text-center max-w-2xl mx-auto">
                    Every compartment, or organelle, has a specialized role. Let's look at the key players.
                </p>
                [Image of a typical eukaryotic animal cell and its organelles]
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="p-4 bg-[var(--gradient-start)] rounded-lg border-l-4 border-yellow-500">
                        <h3 class="font-bold text-yellow-300">Plasma Membrane</h3>
                        <p class="text-sm">The security gate. A selective barrier regulating all substances.</p>
                    </div>
                    <div class="p-4 bg-[var(--gradient-start)] rounded-lg border-l-4 border-purple-500">
                        <h3 class="font-bold text-purple-300">Nucleus</h3>
                        <p class="text-sm">The command center. Stores DNA and directs cell function.</p>
                    </div>
                    <div class="p-4 bg-[var(--gradient-start)] rounded-lg border-l-4 border-red-500">
                        <h3 class="font-bold text-red-300">Mitochondrion</h3>
                        <p class="text-sm">The power plant. Produces ATP (energy) via cellular respiration.</p>
                    </div>
                    <div class="p-4 bg-[var(--gradient-start)] rounded-lg border-l-4 border-green-500">
                        <h3 class="font-bold text-green-300">Cytoskeleton</h3>
                        <p class="text-sm">The scaffolding and railway. Provides structure and internal transport.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. Deep Explanation: Central Dogma (Animated Flow) -->
        <section id="sec-4" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--primary-accent)]">4. The Central Dogma: DNA to Protein</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    This is how genetic instructions become functional proteins. Click to start the flow!
                </p>
                
                <div class="flex justify-center items-center space-x-4 relative p-8 bg-gray-800/50 rounded-xl">
                    <!-- Steps -->
                    <div class="text-center">
                        <div id="dna-box" class="p-3 bg-purple-600 rounded-lg transition-all duration-500">DNA</div>
                        <p class="text-sm mt-1">Template</p>
                    </div>
                    <div class="text-4xl text-gray-500">
                        <span id="arrow1" class="transition-opacity duration-500 opacity-0">&rarr;</span>
                    </div>
                    <div class="text-center">
                        <div id="rna-box" class="p-3 bg-yellow-600 rounded-lg transition-all duration-500">mRNA</div>
                        <p class="text-sm mt-1">Messenger</p>
                    </div>
                    <div class="text-4xl text-gray-500">
                        <span id="arrow2" class="transition-opacity duration-500 opacity-0">&rarr;</span>
                    </div>
                    <div class="text-center">
                        <div id="ribosome-box" class="p-3 bg-red-600 rounded-lg transition-all duration-500">Ribosome</div>
                        <p class="text-sm mt-1">Factory</p>
                    </div>
                </div>

                <div class="h-8">
                    <p id="dogma-status" class="text-xl font-mono text-green-400"></p>
                </div>

                <button class="p-3 px-6 rounded-full bg-[var(--primary-accent)] hover:bg-sky-500 text-white font-bold interactive-element" onclick="startCentralDogma()">
                    Start Protein Synthesis Flow
                </button>
            </div>
        </section>

        <!-- 5. Deep Explanation: Endomembrane System (Animated Pathway) -->
        <section id="sec-5" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)]">5. Endomembrane System: Shipping & Sorting</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    Proteins destined for secretion follow a critical path. Visualize the journey of a secretory protein.
                </p>

                <div class="flex justify-around items-center h-40 relative p-6 bg-gray-800/50 rounded-xl">
                    <div class="text-center w-1/4">
                        <div class="p-4 bg-red-800/70 rounded-lg text-lg font-bold">RER</div>
                        <p class="text-sm mt-1">Synthesis/Folding</p>
                    </div>

                    <!-- Animated path markers, the vesicle moves between these points -->
                    <div class="w-1/4 h-1 bg-gray-600 absolute left-[20%] top-1/2"></div>
                    <div class="w-1/4 h-1 bg-gray-600 absolute left-[55%] top-1/2"></div>

                    <div id="vesicle1" class="vesicle-animation" style="background-color: #fcd34d;"></div>

                    <div class="text-center w-1/4">
                        <div class="p-4 bg-yellow-800/70 rounded-lg text-lg font-bold">Golgi</div>
                        <p class="text-sm mt-1">Modify/Package</p>
                    </div>
                    <div class="text-center w-1/4">
                        <div class="p-4 bg-blue-800/70 rounded-lg text-lg font-bold">Export</div>
                        <p class="text-sm mt-1">Release</p>
                    </div>
                </div>
                <button class="p-3 px-6 rounded-full bg-[var(--primary-accent)] hover:bg-sky-500 text-white font-bold interactive-element" onclick="startVesicleFlow()">
                    Start Vesicle Transit
                </button>
            </div>
        </section>

        <!-- 6. Deep Explanation: The Mitochondria (Interactive ATP Generation) -->
        <section id="sec-6" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--primary-accent)]">6. Mitochondria: The ATP Generator</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    The final step of cellular respiration occurs here. Click the button to 'generate' ATP and track the energy output.
                </p>
                [Image of a mitochondrion structure with cristae]
                <div class="bg-green-900/40 p-6 rounded-xl border border-green-500 max-w-md mx-auto space-y-4">
                    <p class="text-xl font-semibold text-green-300">Total ATP Generated:</p>
                    <div id="atp-counter" class="text-6xl font-extrabold text-white">0</div>
                    <button class="w-full p-4 rounded-lg bg-green-600 hover:bg-green-700 text-white font-bold interactive-element" onclick="generateATP()">
                        Generate ATP (Click)
                    </button>
                </div>
                <p class="text-sm text-gray-400">**Fact:** The inner membrane folds (cristae) increase surface area for maximum ATP synthesis.</p>
            </div>
        </section>

        <!-- 7. Key Concepts: Cytoskeleton and Motility -->
        <section id="sec-7" class="section-container">
            <div class="card p-10 space-y-6">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)]">7. The Cytoskeleton: Structure and Movement</h2>
                <p class="text-lg opacity-80 border-l-4 border-red-400 pl-4 py-2">
                    The cellular skeleton is a dynamic network of fibers critical for structure, motility, and cargo transport.
                </p>
                [Image of the three types of cytoskeleton fibers]
                <ul class="space-y-3">
                    <li class="p-3 bg-[var(--gradient-start)] rounded-lg">
                        <span class="font-bold text-lg text-yellow-300">Microtubules:</span> Thickest. Maintains cell shape, organelle movement, cell division (spindle fibers).
                    </li>
                    <li class="p-3 bg-[var(--gradient-start)] rounded-lg">
                        <span class="font-bold text-lg text-red-300">Microfilaments (Actin):</span> Thinnest. Cell motility, muscle contraction, and cell division (cleavage furrow).
                    </li>
                    <li class="p-3 bg-[var(--gradient-start)] rounded-lg">
                        <span class="font-bold text-lg text-blue-300">Intermediate Filaments:</span> Permanent structures. Anchors organelles, maintains cell shape (e.g., Keratin).
                    </li>
                </ul>
            </div>
        </section>

        <!-- 8. Deep Explanation: Membrane Transport (Interactive Toggle) -->
        <section id="sec-8" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--primary-accent)]">8. Membrane Transport: Gate Control</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    How do materials cross the **selectively permeable** plasma membrane? Toggle the energy requirement.
                </p>

                <div class="flex justify-center space-x-4 mb-6">
                    <button id="btn-passive" class="tab-button p-3 w-40 rounded-full font-bold text-lg bg-gray-600 hover:bg-gray-700 interactive-element transition-colors">Passive</button>
                    <button id="btn-active" class="tab-button p-3 w-40 rounded-full font-bold text-lg bg-red-600 hover:bg-red-700 interactive-element transition-colors">Active</button>
                </div>

                <div id="passive-content" class="tab-content space-y-4 text-left p-6 bg-gray-900/40 border border-gray-500 rounded-xl">
                    <h3 class="text-2xl font-semibold text-gray-300">Passive Transport (No Energy ATP)</h3>
                    <p>Moves substances **Down** the concentration gradient (High &rarr; Low).</p>
                    <ul class="list-disc ml-6 space-y-1 text-sm">
                        <li>**Diffusion:** Small, nonpolar molecules (like Oxygen, Carbon Dioxide).</li>
                        <li>**Osmosis:** Movement of Water.</li>
                        <li>**Facilitated Diffusion:** Uses channel proteins for large/polar molecules.</li>
                    </ul>
                </div>

                <div id="active-content" class="tab-content space-y-4 text-left p-6 bg-red-900/40 border border-red-500 rounded-xl hidden">
                    <h3 class="text-2xl font-semibold text-red-300">Active Transport (Requires ATP)</h3>
                    <p>Moves substances **Against** the concentration gradient (Low &rarr; High).</p>
                    <p class="text-sm">Requires specific carrier proteins (e.g., Sodium-Potassium pump) to maintain steep concentration gradients vital for nerve signaling and nutrient uptake.</p>
                </div>
            </div>
        </section>

        <!-- 9. Visual Diagrams: Mitosis (Step-by-Step Interactive) -->
        <section id="sec-9" class="section-container">
            <div class="card p-10 space-y-6 text-center">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)]">9. Cell Cycle: Mitosis Visualization</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    Mitosis ensures growth and repair by creating two identical daughter cells (diploid - 2n). Click to advance through the phases!
                </p>
                
                <div class="max-w-xs mx-auto my-8 p-4 border-2 border-[var(--primary-accent)] rounded-full relative h-64 flex items-center justify-center">
                    <!-- Cell Diagram Holder -->
                    <div id="cell-diagram" class="w-20 h-20 bg-gray-500 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-1000 ease-in-out">
                        DNA (G1)
                    </div>
                </div>

                <div class="flex justify-center space-x-4">
                    <button class="p-3 px-6 rounded-full bg-red-600 hover:bg-red-700 text-white font-bold interactive-element" onclick="resetMitosis()">Reset</button>
                    <button class="p-3 px-6 rounded-full bg-green-600 hover:bg-green-700 text-white font-bold interactive-element" onclick="nextMitosisStep()">Next Phase</button>
                </div>
                <div class="h-8">
                    <p id="mitosis-status" class="text-xl font-mono text-yellow-300 mt-4">Phase: Interphase (G1)</p>
                </div>
            </div>
        </section>

        <!-- 10. Bioenergetics: The Equations (FIXED: Plain text only, no LaTeX math symbols) -->
        <section id="sec-10" class="section-container">
            <div class="card p-10 space-y-6">
                <h2 class="text-3xl font-bold text-[var(--primary-accent)]">10. Bioenergetics: Photosynthesis vs. Respiration</h2>
                <p class="text-lg opacity-80 max-w-2xl mx-auto">
                    These two processes are the inverse of each other, driving the entire biosphere.
                </p>
                
                <div class="bg-green-900/40 p-6 rounded-xl border border-green-500 space-y-3">
                    <h3 class="text-2xl font-bold text-green-300">Photosynthesis (Chloroplasts)</h3>
                    <p class="text-lg">Captures light energy to create glucose.</p>
                    <p class="text-lg font-mono text-white break-words">
                        6 Carbon Dioxide + 6 Water + Light Energy &rarr; Glucose + 6 Oxygen
                    </p>
                </div>

                <div class="bg-red-900/40 p-6 rounded-xl border border-red-500 space-y-3">
                    <h3 class="text-2xl font-bold text-red-300">Cellular Respiration (Mitochondria)</h3>
                    <p class="text-lg">Breaks down glucose to create usable ATP energy.</p>
                    <p class="text-lg font-mono text-white break-words">
                        Glucose + 6 Oxygen &rarr; 6 Carbon Dioxide + 6 Water + Energy (ATP)
                    </p>
                </div>
            </div>
        </section>

        <!-- 11. Summary & Final Notes -->
        <section id="sec-11" class="section-container">
            <div class="card p-10 space-y-6">
                <h2 class="text-3xl font-bold text-[var(--secondary-accent)]">11. Summary & Final Notes</h2>
                <p class="text-xl opacity-80 border-l-4 border-blue-400 pl-4 py-2">
                    Two crucial concepts that relate back to cell evolution and structure.
                </p>
                
                <div class="question-block p-4 rounded-xl bg-[var(--gradient-start)] border border-[var(--border-color)] interactive-element" onclick="toggleAnswer('endo-info')">
                    <p class="font-semibold text-lg text-yellow-300">Endosymbiosis Theory (Click to reveal)</p>
                    <p id="endo-info" class="text-sm text-gray-400 mt-2 hidden">
                        <span class="font-bold text-green-400">Concept:</span> Explains the origin of mitochondria and chloroplasts. They were once free-living prokaryotes engulfed by an ancestral host cell, forming a symbiotic relationship.
                        <span class="font-bold text-yellow-400 block mt-1">Evidence:</span> Double membranes, their own circular DNA, and they reproduce independently.
                    </p>
                </div>

                <div class="question-block p-4 rounded-xl bg-[var(--gradient-start)] border border-[var(--border-color)] interactive-element" onclick="toggleAnswer('turgor-info')">
                    <p class="font-semibold text-lg text-yellow-300">Turgor Pressure (Click to reveal)</p>
                    <p id="turgor-info" class="text-sm text-gray-400 mt-2 hidden">
                        <span class="font-bold text-green-400">Concept:</span> The pressure exerted by Water pushing outward against the cell wall in plant cells. This is vital for maintaining plant rigidity (structure).
                    </p>
                </div>
                
                <p class="pt-4 text-center text-gray-500 text-sm">You have completed the Cell Biology Lesson!</p>
            </div>
        </section>

        <footer class="text-center text-gray-500 pt-10 pb-16 text-sm">
            End of Interactive Lesson. Review the sections above to solidify your knowledge.
        </footer>
    </div>

    <script>
        // --- GLOBAL STATE ---
        let atpCount = 0;
        let mitosisPhase = 0;
        const mitosisPhases = ["Interphase (G1)", "S Phase (DNA Replicates)", "Prophase (Chromosomes Condense)", "Metaphase (Chromosomes Align)", "Anaphase (Sister Chromatids Separate)", "Telophase (Nuclei Reform)"];


        // --- SECTION SCROLL ANIMATION (Intersection Observer) ---
        const sections = document.querySelectorAll('.section-container');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, {
            threshold: 0.1 // Triggers when 10% of the section is visible
        });

        sections.forEach(section => {
            observer.observe(section);
        });

        // --- GENERAL INTERACTIVITY ---
        const toggleAnswer = (id) => {
            document.getElementById(id).classList.toggle('hidden');
        };


        // --- SECTION 2: PRO/EU TOGGLE ---
        const proContent = document.getElementById('pro-content');
        const euContent = document.getElementById('eu-content');
        const btnPro = document.getElementById('btn-pro');
        const btnEu = document.getElementById('btn-eu');

        btnPro.onclick = () => {
            proContent.classList.remove('hidden');
            euContent.classList.add('hidden');
            btnPro.classList.add('ring-4', 'ring-red-300');
            btnEu.classList.remove('ring-4', 'ring-blue-300');
        };

        btnEu.onclick = () => {
            proContent.classList.add('hidden');
            euContent.classList.remove('hidden');
            btnEu.classList.add('ring-4', 'ring-blue-300');
            btnPro.classList.remove('ring-4', 'ring-red-300');
        };
        // Initial state setup
        btnPro.classList.add('ring-4', 'ring-red-300'); 

        // --- SECTION 4: CENTRAL DOGMA ANIMATION ---
        const dogmaStatus = document.getElementById('dogma-status');
        const arrow1 = document.getElementById('arrow1');
        const arrow2 = document.getElementById('arrow2');
        const rnaBox = document.getElementById('rna-box');
        const ribosomeBox = document.getElementById('ribosome-box');

        const resetCentralDogma = () => {
            arrow1.style.opacity = 0;
            arrow2.style.opacity = 0;
            rnaBox.style.transform = 'scale(1)';
            ribosomeBox.style.transform = 'scale(1)';
            dogmaStatus.textContent = '';
        }

        const startCentralDogma = async () => {
            resetCentralDogma();
            dogmaStatus.textContent = "1. Transcription: DNA -> mRNA (in Nucleus)";
            
            // Step 1: DNA -> mRNA
            arrow1.style.opacity = 1;
            rnaBox.style.transform = 'scale(1.1)';
            await new Promise(resolve => setTimeout(resolve, 1500)); 
            rnaBox.style.transform = 'scale(1)';

            // Step 2: mRNA -> Ribosome
            dogmaStatus.textContent = "2. Translation: mRNA -> Protein (at Ribosome)";
            arrow2.style.opacity = 1;
            ribosomeBox.style.transform = 'scale(1.1)';
            await new Promise(resolve => setTimeout(resolve, 1500)); 
            ribosomeBox.style.transform = 'scale(1)';
            
            dogmaStatus.textContent = "Protein Synthesis Complete!";
            await new Promise(resolve => setTimeout(resolve, 1000));
            resetCentralDogma();
        }


        // --- SECTION 5: ENDOMEMBRANE SYSTEM ANIMATION ---
        const vesicle = document.getElementById('vesicle1');

        const startVesicleFlow = () => {
            // Clear any previous animation
            vesicle.classList.remove('active');
            void vesicle.offsetWidth; // Force reflow/restart
            vesicle.style.opacity = 1;
            vesicle.classList.add('active');
            
            // Hide at the end of animation
            vesicle.addEventListener('animationend', () => {
                vesicle.classList.remove('active');
                vesicle.style.opacity = 0;
            }, { once: true });
        };


        // --- SECTION 6: ATP GENERATION ---
        const atpCounter = document.getElementById('atp-counter');

        const generateATP = () => {
            atpCount += 3; // Simulate the net gain of a few ATP per glucose molecule cycle step
            atpCounter.textContent = atpCount.toString();
            
            // Visual feedback
            atpCounter.classList.add('text-yellow-300', 'scale-110');
            setTimeout(() => {
                atpCounter.classList.remove('text-yellow-300', 'scale-110');
            }, 300);
        };

        // --- SECTION 8: TRANSPORT TOGGLE ---
        const passiveContent = document.getElementById('passive-content');
        const activeContent = document.getElementById('active-content');
        const btnPassive = document.getElementById('btn-passive');
        const btnActive = document.getElementById('btn-active');

        btnPassive.onclick = () => {
            passiveContent.classList.remove('hidden');
            activeContent.classList.add('hidden');
            btnPassive.classList.add('ring-4', 'ring-gray-300');
            btnActive.classList.remove('ring-4', 'ring-red-300');
        };

        btnActive.onclick = () => {
            passiveContent.classList.add('hidden');
            activeContent.classList.remove('hidden');
            btnActive.classList.add('ring-4', 'ring-red-300');
            btnPassive.classList.remove('ring-4', 'ring-gray-300');
        };
        // Initial state setup
        btnPassive.classList.add('ring-4', 'ring-gray-300'); 

        // --- SECTION 9: MITOSIS STEPPER ---
        const cellDiagram = document.getElementById('cell-diagram');
        const mitosisStatus = document.getElementById('mitosis-status');

        const updateCellDiagram = () => {
            const phase = mitosisPhases[mitosisPhase];
            mitosisStatus.textContent = `Phase: ${phase}`;
            cellDiagram.textContent = phase.split(' ')[0]; // Show short phase name

            // Resetting and adding class for transition
            cellDiagram.className = '';
            cellDiagram.classList.add('w-20', 'h-20', 'rounded-full', 'flex', 'items-center', 'justify-center', 'text-xs', 'font-bold', 'transition-all', 'duration-1000', 'ease-in-out', 'bg-gray-500');

            switch(mitosisPhase) {
                case 0: // Interphase
                    cellDiagram.style.backgroundColor = 'rgba(74, 222, 128, 0.8)'; // Green
                    cellDiagram.style.borderRadius = '50%';
                    cellDiagram.style.transform = 'scale(1)';
                    break;
                case 1: // S Phase (DNA Replicates - gets "busy")
                    cellDiagram.style.backgroundColor = 'rgba(251, 191, 36, 0.8)'; // Yellow
                    cellDiagram.style.borderRadius = '50%';
                    cellDiagram.style.transform = 'scale(1.1)';
                    break;
                case 2: // Prophase (Condense)
                    cellDiagram.style.backgroundColor = 'rgba(248, 113, 113, 0.8)'; // Red
                    cellDiagram.style.borderRadius = '50%';
                    cellDiagram.style.transform = 'scale(0.9) rotate(360deg)';
                    break;
                case 3: // Metaphase (Align)
                    cellDiagram.style.backgroundColor = 'rgba(96, 165, 250, 0.8)'; // Blue
                    cellDiagram.style.borderRadius = '50%';
                    cellDiagram.style.transform = 'translateY(0) scale(1.1)';
                    cellDiagram.innerHTML = '<span class="text-white">Align!</span>'; // Custom text/visual cue
                    break;
                case 4: // Anaphase (Separate)
                    cellDiagram.style.backgroundColor = 'rgba(250, 204, 21, 0.8)'; // Amber
                    cellDiagram.style.borderRadius = '30%'; // Stretches
                    cellDiagram.style.transform = 'scale(1.5, 0.7)'; // Stretches vertically
                    cellDiagram.innerHTML = '<span class="text-white">Pull!</span>';
                    break;
                case 5: // Telophase (Reform)
                    cellDiagram.style.backgroundColor = 'rgba(167, 139, 250, 0.8)'; // Violet
                    cellDiagram.style.borderRadius = '10%'; // Splitting visually
                    cellDiagram.style.transform = 'scale(1.3)';
                    cellDiagram.innerHTML = '<span class="text-white">TWO!</span>';
                    break;
            }
        };

        const nextMitosisStep = () => {
            mitosisPhase = (mitosisPhase + 1) % mitosisPhases.length;
            updateCellDiagram();
        };

        const resetMitosis = () => {
            mitosisPhase = 0;
            updateCellDiagram();
        };

        // --- INITIALIZATION ---
        window.addEventListener('load', () => {
            updateCellDiagram(); // Initial state for Mitosis
        });
    </script>
</body>
</html>
